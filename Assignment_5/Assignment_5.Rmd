---
title: "Assignment 5"
author: "Melissa Dennis"
date: "2025-11-22"
output: word_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```
Read data
```{r}
cereal.df <- read.csv("C:/Users/m_den/OneDrive/Documents/GitHub/64060_-mdenni23/Assignment_5/Cereals.csv")
```
Evaluate the data
```{r}
str(cereal.df)
```

```{r}
summary(cereal.df)
```
```{r}
##Remove NA
df <- na.omit(cereal.df)
```


```{r}
##Examine dataset
head(df)
```

Convert the names of cereals to row names
```{r}
##Convert Names to row names
rownames(df) <- df$name

##Remove duplicate column
df$name = NULL
```

```{r} 
##Remove MFR and Type columns
df <- df[,-(1:2)]
head(df)
```

Scaling and standardizing dataset
```{r}
df <- scale(df, center = T, scale = T)

#Reexamine the scaled data
head(df) 
```


Load libraries
```{r}
library(stats)
library(cluster)
library(factoextra)
library(tidyverse)
```

Calculate the distance measures
```{r}
##Use the euclidean distance measure
dist <- dist(df, method = "euclidean")

hc_fit <- hclust(dist, method = "ward.D2")
```

Plot using complete, single, ward, and avereage to determine which linkage is best
```{r}
hc1 <- hclust(dist, method = "complete")
plot(hc1, cex = 0.3, hang = -1)
```
Plot using average
```{r}
hc2 <- hclust(dist, method = "average")
plot(hc2, cex = 0.3, hang = -1)
```
Plot using median
```{r}
hc3 <- hclust(dist, method = "median")
plot(hc3, cex = 0.3, hang = -1)
```
Plot using centroid
```{r}
hc4 <- hclust(dist, method = "centroid")
plot(hc4, cex = 0.3, hang = -1)
```
Plot using ward
```{r}
hc5 <- hclust(dist, method = "ward.D2")
plot(hc5, cex = 0.3, hang = -1)
```
Plot using single
```{r}
hc6 <- hclust(dist, method = "single")
plot(hc6, cex = 0.3, hang = -1)
```
Calculate and plot using Agnes for each linkage
```{r}
##Compute with agnes and with different linkage methods
hc_single <- agnes(df, method = "single")
hc_complete <- agnes(df, method = "complete")
hc_average <- agnes(df, method = "average")
hc_ward <- agnes(df, method = "ward")

##Compare Agglomerative coefficients
pltree(hc_complete, cex = 0.3, hang = -1, main = "Dendrogram of Complete Agnes")
```

```{r}
pltree(hc_average, cex = 0.3, hang = -1, main = "Dendrogram of Average Agnes")
```

```{r}
pltree(hc_single, cex = 0.3, hang = -1, main = "Dendrogram of Single Agnes")
```

```{r}
pltree(hc_ward, cex = 0.3, hang = -1, main = "Dendrogram of Ward Agnes")
```

Print the Agglomerative coefficient for each linkage.
```{r}
print(hc_single$ac)

print(hc_complete$ac)

print(hc_average$ac)

print(hc_ward$ac)

```
Ward linkage provides the strongest clustering structure because of it has the highest Agglomerative coefficient.

Using a height cutoff of 10, 6 cluster can be established.

```{r}
##Plot ward linkage with 6 clusters bordered
plot(hc_fit, cex = 0.3, hang = -1, main = "Dendrogram of Ward Agnes", xlab = "Cereal Name")

rect.hclust(hc_fit, k = 6, border = 2:8)
```


Add column to dataset denoted the cluster the cereal is located in
```{r}
points_hc <- cutree(hc_fit, k = 6)

##Store the clusters in a data frame along with the cereals data

cereals_clusts_hc <- cbind(points_hc, df)

##The head of the new data frame

colnames(cereals_clusts_hc)[1] <- "cluster_hc"

head(cereals_clusts_hc)
```
Print the cereal and assigned cluster
```{r}
memb <- cutree(hc_fit, k = 6)
memb

```


Plot clusters on a heat map

```{r}
##Set labels
row.names(cereals_clusts_hc) <- paste(memb, ": ", row.names(cereals_clusts_hc), sep = "")

##Create a dendrogram object
##We use as.dendrogram so heatmap knows how to handle it
my_dendrogram <- as.dendrogram(hc5)

##Plot heatmap
heatmap(as.matrix(cereals_clusts_hc), 
        Rowv = my_dendrogram, 
        Colv = NA, 
        col = rev(paste("grey",1:99,sep="")),
        scale = "none",
        main = "Heatmap Ordered by Ward Clustering (k=6)"
        )
```

Build a kmeans model with k = 2
```{r}
set.seed(123)
km_basic <- kmeans(cereals_clusts_hc, centers = 2)

str(km_basic)
```

Plot cereals in 2 clusters
```{r}
fviz_cluster(km_basic, df)
```

```{r}
cat("The elementary public schools would like to choose a set of cereals to include in their daily cafeterias. Every day a different cereal is offered, but all cereals should support a healthy diet. For this goal, you are requested to find a cluster of “healthy cereals.” Should the data be normalized? If not, how should they be used in the cluster analysis? \n\nElementary public schools should choose cluster 1 as this has the healthiest selection of cereals. The cluster that has the lowest values for unhealthy metrics like sugar and fat and the highest values for healthy metrics like fiber and vitamins. Normalizing the data will allow the clustering algorithm to find this group effectively. Normalization is crucial for this analysis because cereals have features measured on different scales. Without normalization, features with larger absolute values would have a greater influence on the distance calculation, leading to a distorted cluster structure")
```



Cluster the data to confirm which cereals are the best choice. 
```{r}
sub_grp <- cutree(hc5, k = 6)
```
Print the clusters
```{r}
fviz_cluster(list(data = df, cluster = sub_grp))
```

