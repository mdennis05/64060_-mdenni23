---
title: "Assignment 5"
author: "Melissa Dennis"
date: "2025-11-22"
output: word_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```
Read data
```{r}
cereal.df <- read.csv("C:/Users/m_den/OneDrive/Documents/GitHub/64060_-mdenni23/Assignment_5/Cereals.csv")
```
Evaluate the data
```{r}
str(cereal.df)
```

```{r}
summary(cereal.df)
```

```{r}
##Examine dataset
head(cereal.df)
```

Convert the names of cereals to row names
```{r}
##Convert Names to row names
rownames(cereal.df) <- cereal.df$name

##Remove duplicate column
cereal.df$name = NULL
```

```{r} 
##Remove MFR and Type columns
cereal.df <- cereal.df[,-(1:2)]
head(cereal.df)
```

Scaling and standardizing dataset
```{r}
df <- scale(cereal.df, center = T, scale = T)

#Reexamine the scaled data
head(df) 
```


Load libraries
```{r}
library(stats)
library(cluster)
library(factoextra)
```

Calculate the distance measures
```{r}
##Use the euclidean distance measure
dist <- dist(cereal.df, method = "euclidean")

hc_fit <- hclust(dist, method = "ward.D2")
```

Plot using complete
```{r}
# in hclust() set argument method =  
# to "ward.D", "single", "complete", "average", "median", or "centroid"
hc1 <- hclust(dist, method = "complete")
plot(hc1, cex = 0.3, hang = -1)
```
Plot using average
```{r}
hc2 <- hclust(dist, method = "average")
plot(hc2, cex = 0.3, hang = -1)
```
Plot using median
```{r}
hc3 <- hclust(dist, method = "median")
plot(hc3, cex = 0.3, hang = -1)
```
Plot using centroid
```{r}
hc4 <- hclust(dist, method = "centroid")
plot(hc4, cex = 0.3, hang = -1)
```
Plot using ward
```{r}
hc5 <- hclust(dist, method = "ward.D2")
plot(hc5, cex = 0.3, hang = -1)
```
Plot using single
```{r}
hc6 <- hclust(dist, method = "single")
plot(hc6, cex = 0.3, hang = -1)
```

```{r}
##Compute with agnes and with different linkage methods
hc_single <- agnes(cereal.df, method = "single")
hc_complete <- agnes(cereal.df, method = "complete")
hc_average <- agnes(cereal.df, method = "average")
hc_ward <- agnes(cereal.df, method = "ward")

##Compare Agglomerative coefficients
pltree(hc_complete, cex = 0.3, hang = -1, main = "Dendrogram of Complete Agnes")
```

```{r}
pltree(hc_average, cex = 0.3, hang = -1, main = "Dendrogram of Average Agnes")
```

```{r}
pltree(hc_single, cex = 0.3, hang = -1, main = "Dendrogram of Single Agnes")
```

```{r}
pltree(hc_ward, cex = 0.3, hang = -1, main = "Dendrogram of Ward Agnes")
```


```{r}
print(hc_single$ac)

print(hc_complete$ac)

print(hc_average$ac)

print(hc_ward$ac)

```
Ward linkage provides the strongest clustering structure because of it has the highest Agglomerative coefficient.

Using a height cutoff of 200, 10 cluster can be established.

```{r}
pltree(hc_ward,cex = 0.3, hang = -1, main = "Dendrogram of Ward Agnes", xlab = "Cereal Name")

rect.hclust(hc_ward, k = 6, border = 2:10)
```
Add column to dataset denoted the cluster the cereal is located in
```{r}
points_hc <- cutree(hc_ward, k = 6)

##Store the clusters in a data frame along with the cereals data

cereals_clusts_hc <- cbind(points_hc, cereal.df)

##The head of the new data frame

colnames(cereals_clusts_hc)[1] <- "cluster_hc"

head(cereals_clusts_hc)
```
Print the cereal and assigned cluster
```{r}
memb <- cutree(hc_ward, k = 6)
memb

```


Plot clusters on a heat map
```{r}
##set labels as cluster membership and cereal name
row.names(df) <- paste(memb, ": ", row.names(cereals_clusts_hc), sep = "")

##plot heatmap 
heatmap(as.matrix(df), Colv = NA, hclustfun = hclust, 
        col=rev(paste("grey",1:99,sep="")))
```




